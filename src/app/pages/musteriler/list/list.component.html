<div class="container py-4">


  <div 
    class="d-flex justify-content-between align-items-center pb-2 mb-3" 
    style="border-bottom: 1px solid #dee2e6;">
    

    <h3 class="m-0" style="color: #003D7C; font-weight: 600;">Müşteri Yönetimi</h3>
    

    <a 
      class="btn d-flex align-items-center gap-2"
      [routerLink]="['/musteriler/yeni']"
      style="background-color: #E11A24; color: white; border-color: #E11A24; border-radius: 0.375rem; font-weight: 500;">
      <i class="bi bi-plus-lg"></i>
      <span>Yeni Müşteri Ekle</span>
    </a>
  </div>

  <div class="p-3 mb-3" style="background-color: #f8f9fa; border: 1px solid #dee2e6; border-radius: 0.375rem;">
    <div class="d-flex gap-2">
      <input
        class="form-control"
        [(ngModel)]="q"
        placeholder="Müşteri No veya Ad/Ünvan ile arama yapın..."
        (keyup.enter)="ara()"
      />
      <button class="btn btn-outline-secondary" type="button" (click)="ara()" style="min-width: 100px;">
        <i class="bi bi-search"></i> Ara
      </button>
      <button class="btn btn-outline-dark" type="button" (click)="temizle()">Temizle</button>
    </div>
  </div>

  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border" role="status" style="color: #003D7C; width: 3rem; height: 3rem;">
      <span class="visually-hidden">Yükleniyor...</span>
    </div>
    <div class="mt-2" style="color: #003D7C; font-size: 1.1rem;">Veriler Yükleniyor...</div>
  </div>

  <div class="table-responsive" *ngIf="!loading">
    <table class="table table-hover align-middle" style="border: 1px solid #dee2e6;">
      
      <thead style="background-color: #f8f9fa;">
        <tr>
          <th scope="col" style="color: #003D7C; font-weight: 600; padding: 0.75rem;">#</th>
          <th scope="col" style="color: #003D7C; font-weight: 600; padding: 0.75rem;">Müşteri No</th>
          <th scope="col" style="color: #003D7C; font-weight: 600; padding: 0.75rem;">Ad / Ünvan</th>
          <th scope="col" style="color: #003D7C; font-weight: 600; padding: 0.75rem;">Soyad</th>
          <th scope="col" style="color: #003D7C; font-weight: 600; padding: 0.75rem;">TCKN</th>
          <th scope="col" style="color: #003D7C; font-weight: 600; padding: 0.75rem;">Borçlu Tipi</th>
          <th scope="col" class="text-end" style="color: #003D7C; font-weight: 600; padding: 0.75rem; width: 180px;">İşlemler</th>
        </tr>
      </thead>
      
      <tbody>
        <tr *ngFor="let m of data.items; index as i">
          <td>{{ (page - 1) * pageSize + i + 1 }}</td>
          <td>{{ m.musteriNo }}</td>
          <td>{{ m.adiUnvani || '-' }}</td>
          <td>{{ m.borcluSoyadi || '-' }}</td>
          <td>{{ m.tckn || '-' }}</td>
         <td style="font-weight: 500;">
            <i class="bi" 
               [ngClass]="m.borcluTipi === 1 ? 'bi-person-fill text-dark' : 'bi-building-fill text-dark'" 
               style="margin-right: 5px; font-size: 0.9rem;"></i>
            <span class="text-dark">
              {{ m.borcluTipi === 1 ? 'Bireysel' : (m.borcluTipi === 2 ? 'Kurumsal' : '-') }}
            </span>
          </td>
          <td class="text-end">
            <a
              class="btn btn-sm btn-outline-secondary me-2"
              [routerLink]="['/musteriler/duzenle', m.id]"
              title="Düzenle"
              style="--bs-btn-color: #003D7C; --bs-btn-border-color: #003D7C; --bs-btn-hover-bg: #003D7C; --bs-btn-hover-color: #fff;"
            >
              <i class="bi bi-pencil-fill"></i>
              <span class="d-none d-md-inline ms-1">Düzenle</span>
            </a>
            <button
              class="btn btn-sm btn-outline-danger"
              (click)="delete(m)"
              [disabled]="silLoadingId === m.id"
              title="Sil"
            >
              <i *ngIf="silLoadingId !== m.id" class="bi bi-trash-fill"></i>
              <span *ngIf="silLoadingId === m.id" class="spinner-border spinner-border-sm"></span>
              <span *ngIf="silLoadingId !== m.id" class="d-none d-md-inline ms-1">Sil</span>
            </button>
          </td>
        </tr>
        
        <tr *ngIf="data.items.length === 0">
          <td colspan="5" class="text-center text-muted py-4">
            Gösterilecek kayıt bulunamadı.
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="d-flex justify-content-between align-items-center mt-2" *ngIf="!loading && data.totalCount > 0">
    <div>
      Toplam: <strong>{{ data.totalCount }}</strong> Kayıt
    </div>
    
    <nav *ngIf="toplamSayfa > 1">
      <ul class="pagination m-0">
        <li class="page-item" [class.disabled]="page === 1">
          <button class="page-link" (click)="yenile(page - 1)">&laquo; Önceki</button>
        </li>
        <li class="page-item disabled">
          <span class="page-link">{{ page }} / {{ toplamSayfa }}</span>
        </li>
        <li class="page-item" [class.disabled]="page >= toplamSayfa">
          <button class="page-link" (click)="yenile(page + 1)">Sonraki &raquo;</button>
        </li>
      </ul>
    </nav>
    
    <div class="d-flex align-items-center gap-2">
      <label class="text-nowrap">Göster:</label>
      <select class="form-select form-select-sm" style="width: auto" [(ngModel)]="pageSize" (change)="yenile(1)">
        <option [ngValue]="10">10</option>
        <option [ngValue]="20">20</option>
        <option [ngValue]="50">50</option>
      </select>
    </div>
  </div>

</div>
