<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center pb-2 mb-3" style="border-bottom: 1px solid #dee2e6;">
    <h3 class="m-0" style="color: #003D7C; font-weight: 600;">İhtarlar</h3>
    <a class="btn d-flex align-items-center gap-2" [routerLink]="['/ihtarlar/yeni']"
      style="background-color: #E11A24; color: white; border-color: #E11A24; border-radius: 0.375rem; font-weight: 500;">
      <i class="bi bi-plus-lg"></i>
      <span>Yeni İhtar Ekle</span>
    </a>
  </div>

  <div class="p-3 mb-3" style="background-color: #f8f9fa; border: 1px solid #dee2e6; border-radius: 0.375rem;">
    <div class="d-flex gap-2">
      <input class="form-control" placeholder="Müşteri adı, ihtar no veya yevmiye no ile ara..."
        [ngModel]="arama()" (ngModelChange)="arama.set($event)" (keyup.enter)="ara()" />
      <button class="btn btn-outline-secondary" type="button" (click)="ara()" style="min-width: 100px;">
        <i class="bi bi-search"></i> Ara
      </button>
    </div>
  </div>

  <div *ngIf="yukleniyor()" class="text-center py-5">
    <div class="spinner-border" role="status" style="color: #003D7C; width: 3rem; height: 3rem;">
      <span class="visually-hidden">Yükleniyor...</span>
    </div>
    <div class="mt-2" style="color: #003D7C; font-size: 1.1rem;">Veriler Yükleniyor...</div>
  </div>

  <div class="table-responsive" *ngIf="!yukleniyor()">
    <table class="table table-hover align-middle" style="border: 1px solid #dee2e6;">

      <thead style="background-color: #f8f9fa;">
        <tr>
          <th scope="col" style="color: #003D7C; font-weight: 600; padding: 0.75rem;">#</th>
          <th scope="col" style="color: #003D7C; font-weight: 600; padding: 0.75rem;">IhtarId</th>
          <th scope="col" style="color: #003D7C; font-weight: 600; padding: 0.75rem;">Müşteri</th>
          <th scope="col" style="color: #003D7C; font-weight: 600; padding: 0.75rem;">İhtar Tarihi</th>
          <th scope="col" style="color: #003D7C; font-weight: 600; padding: 0.75rem;">İhtar No</th>
          <th scope="col" style="color: #003D7C; font-weight: 600; padding: 0.75rem;">Yevmiye</th>
          <th scope="col" style="color: #003D7C; font-weight: 600; padding: 0.75rem;">Nakit Tutar</th>
         <th scope="col" class="text-end" style="color: #003D7C; font-weight: 600; padding: 0.75rem; width: 180px;">İşlemler</th>


        </tr>
      </thead>
      
      <tbody>

        <tr *ngFor="let k of kayitlar(); let i = index">
          <td>{{ i + 1 + (sayfa() - 1) * sayfaBoyutu() }}</td>
          <td>{{k.id}}</td>
          <td>{{ k.musteriAd }}</td>
          <td>{{ k.ihtarTarihi | date : 'dd.MM.yyyy' }}</td> 
          <td>{{ k.ihtarNo || '-' }}</td>
          <td>{{ k.yevmiyeNo || '-' }}</td>
          <td>{{ k.ihtarnameNakitTutar | number : '1.2-2' }}</td>
          <td class="text-end">

            <a class="btn btn-sm btn-outline-secondary me-2" [routerLink]="['/ihtarlar/duzenle', k.id]" title="Düzenle"
              style="--bs-btn-color: #003D7C; --bs-btn-border-color: #003D7C; --bs-btn-hover-bg: #003D7C; --bs-btn-hover-color: #fff;">
              <i class="bi bi-pencil-fill"></i>
              <span class="d-none d-md-inline ms-1">Düzenle</span>
            </a>

            <button class="btn btn-sm btn-outline-danger" (click)="sil(k.id)" title="Sil">
              <i class="bi bi-trash-fill"></i>
              <span class="d-none d-md-inline ms-1">Sil</span>
            </button>
          </td>
        </tr>

        <tr *ngIf="kayitlar().length === 0">
          <td colspan="9" class="text-center text-muted py-4">
            Gösterilecek kayıt bulunamadı.
          </td>
        </tr>
      </tbody>
    </table>
  </div>


  <div class="d-flex justify-content-between align-items-center mt-2" *ngIf="!yukleniyor() && toplam() > 0">
    <div>
      Toplam: <strong>{{ toplam() }}</strong> Kayıt
    </div>

    <nav *ngIf="(toplam() / sayfaBoyutu()) > 1">
      <ul class="pagination m-0">
        <li class="page-item" [class.disabled]="sayfa() === 1">
          <button class="page-link" (click)="sayfa.set(sayfa() - 1)">&laquo; Önceki</button>
        </li>
        <li class="page-item disabled">
          <span class="page-link">{{ sayfa() }} / {{ Math.ceil(toplam() / sayfaBoyutu()) }}</span>
        </li>
        <li class="page-item" [class.disabled]="sayfa() * sayfaBoyutu() >= toplam()">
          <button class="page-link" (click)="sayfa.set(sayfa() + 1)">Sonraki &raquo;</button>
        </li>
      </ul>
    </nav>
    
    <div class="d-flex align-items-center gap-2">
      <label class="text-nowrap">Göster:</label>
      <select class="form-select form-select-sm" style="width: auto" 
              [ngModel]="sayfaBoyutu()" 
              (ngModelChange)="sayfaBoyutu.set(+$event); ara()">
        <option [ngValue]="10">10</option>
        <option [ngValue]="20">20</option>
        <option [ngValue]="50">50</option>
      </select>
    </div>
  </div>

</div>
